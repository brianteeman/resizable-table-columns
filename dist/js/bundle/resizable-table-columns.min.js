!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).validide_resizableTableColumns=t()}(this,function(){"use strict";var s=(n.escapeRegExp=function(e){return e.replace(n.regexEscapeRegex,"\\$&")},n.kebabCaseToCamelCase=function(e){return e.replace(n.kebabCaseRegex,function(e){return e[1].toUpperCase()})},n.parseStringToType=function(e){if(0==e.length||n.onlyWhiteSpace.test(e))return e;if(n.trueRegex.test(e))return!0;if(n.falseRegex.test(e))return!1;if(n.notEmptyOrWhiteSpace.test(e)){var t=+e;if(!isNaN(t))return t}return e},n.parseStyleDimension=function(e,t){if("string"==typeof e){if(e.length){var n=e.replace("px","").replace(",","."),i=parseFloat(n);if(!isNaN(i))return i}}else if("number"==typeof e)return e;return t?e:0},n.regexEscapeRegex=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,n.kebabCaseRegex=/(\-\w)/g,n.trueRegex=/^true$/i,n.falseRegex=/^false$/i,n.onlyWhiteSpace=/^\s$/,n.notEmptyOrWhiteSpace=/\S/,n);function n(){}var g=(r.addClass=function(e,t){e.classList?e.classList.add(t):r.hasClass(e,t)||(e.className+=" "+t)},r.removeClass=function(e,t){var n;e.classList?e.classList.remove(t):r.hasClass(e,t)&&(n=new RegExp("(\\s|^)"+s.escapeRegExp(t)+"(\\s|$)"),e.className=e.className.replace(n," "))},r.hasClass=function(e,t){return e.classList?e.classList.contains(t):!!e.className.match(new RegExp("(\\s|^)"+s.escapeRegExp(t)+"(\\s|$)"))},r.getDataAttributesValues=function(e){if(!e)return null;var t={};if(e.dataset)for(var n in e.dataset)e.dataset.hasOwnProperty(n)&&(t[n]=s.parseStringToType(e.dataset[n]||""));else for(var i=0;i<e.attributes.length;i++)/^data\-/.test(e.attributes[i].name)&&(t[s.kebabCaseToCamelCase(e.attributes[i].name.replace("data-",""))]=s.parseStringToType(e.attributes[i].value));return t},r.getMinCssWidth=function(e){var t,n=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).minWidth,i=s.parseStyleDimension(n,!0);return"number"!=typeof i||isNaN(i)?null:i},r.getMaxCssWidth=function(e){var t,n=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).maxWidth,i=s.parseStyleDimension(n,!0);return"number"!=typeof i||isNaN(i)?null:i},r.getOuterWidth=function(e,t){var n;void 0===t&&(t=!1);var i=e.offsetWidth;if(!t)return i;var a=null===(n=e.ownerDocument.defaultView)||void 0===n?void 0:n.getComputedStyle(e);return i+s.parseStyleDimension(null==a?void 0:a.marginTop,!1)+s.parseStyleDimension(null==a?void 0:a.marginBottom,!1)},r.getInnerWidth=function(e){var t,n=r.getOuterWidth(e),i=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e);return n-s.parseStyleDimension(null==i?void 0:i.borderLeft,!1)-s.parseStyleDimension(null==i?void 0:i.borderRight,!1)},r.getWidth=function(e){var t,n=r.getOuterWidth(e),i=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e);return"border-box"===(null==i?void 0:i.boxSizing)?n:n-s.parseStyleDimension(null==i?void 0:i.paddingLeft,!1)-s.parseStyleDimension(null==i?void 0:i.paddingRight,!1)-s.parseStyleDimension(null==i?void 0:i.borderLeft,!1)-s.parseStyleDimension(null==i?void 0:i.borderRight,!1)},r.getOuterHeight=function(e,t){var n;void 0===t&&(t=!1);var i=e.offsetHeight;if(!t)return i;var a=null===(n=e.ownerDocument.defaultView)||void 0===n?void 0:n.getComputedStyle(e);return i+s.parseStyleDimension(null==a?void 0:a.marginTop,!1)+s.parseStyleDimension(null==a?void 0:a.marginBottom,!1)},r.getInnerHeight=function(e){var t,n=r.getOuterHeight(e),i=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e);return n-s.parseStyleDimension(null==i?void 0:i.borderTop,!1)-s.parseStyleDimension(null==i?void 0:i.borderBottom,!1)},r.getHeight=function(e){var t,n=r.getOuterHeight(e),i=null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e);return n-s.parseStyleDimension(null==i?void 0:i.paddingTop,!1)-s.parseStyleDimension(null==i?void 0:i.paddingBottom,!1)-s.parseStyleDimension(null==i?void 0:i.borderTop,!1)-s.parseStyleDimension(null==i?void 0:i.borderBottom,!1)},r.getOffset=function(e){if(!e)return{top:0,left:0};var t=e.getBoundingClientRect();return{top:t.top+e.ownerDocument.body.scrollTop,left:t.left+e.ownerDocument.body.scrollLeft}},r.matches=function(e,t){for(var n=void 0,i=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],a=0;a<i.length;a++)if("function"==typeof e.ownerDocument.body[i[a]]){n=i[a];break}return!!n&&e[n](t)},r.closest=function(e,t){if(!e)return null;if("function"==typeof e.closest)return e.closest(t);for(var n=e;n&&1===n.nodeType;){if(r.matches(n,t))return n;n=n.parentNode}return null},r.getPointerX=function(e){if(0===e.type.indexOf("touch")){if(e.touches&&e.touches.length)return e.touches[0].pageX;if(e.changedTouches&&e.changedTouches.length)return e.changedTouches[0].pageX}return e.pageX},r.getTextWidth=function(e,t){var n,i;if(!e||!t)return 0;var a=(null===(n=e.textContent)||void 0===n?void 0:n.trim().replace(/\s/g,"&nbsp;"))+"&nbsp;",s=null===(i=e.ownerDocument.defaultView)||void 0===i?void 0:i.getComputedStyle(e);return["fontFamily","fontSize","fontWeight","padding","border","boxSizing"].forEach(function(e){t.style[e]=s[e]}),t.innerHTML=a,r.getOuterWidth(t,!0)},r);function r(){}var i=(e.prototype.overrideValues=function(e){if(void 0===e&&(e=null),e)for(var t in e)this.hasOwnProperty(t)&&(this[t]=e[t])},e.prototype.overrideValuesFromElement=function(e){var t;void 0===e&&(e=null),e&&(t=g.getDataAttributesValues(e),this.overrideValues(t))},e);function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.resizeFromBody=!0,this.minWidth=40,this.maxWidth=null,this.obeyCssMinWidth=!1,this.obeyCssMaxWidth=!1,this.doubleClickDelay=500,this.store=null,this.overrideValues(e),this.overrideValuesFromElement(t)}var a=function(){this.column=0,this.table=0},o=function(){this.x=null,this.isDoubleClick=!1},c=function(e,t){this.pointer=new o,this.originalWidths=new a,this.newWidths=new a,this.column=e,this.dragHandler=t},y=(t.dataPropertyname="validide_rtc_data_object",t.classes={table:"rtc-table",wrapper:"rtc-wrapper",handleContainer:"rtc-handle-container",handle:"rtc-handle",tableResizing:"rtc-table-resizing",columnResizing:"rtc-column-resizing"},t.attibutes={dataResizable:"data-rtc-resizable",dataResizableTable:"data-rtc-resizable-table"},t.data={resizable:"rtcResizable",resizableTable:"rtcResizableTable"},t.events={pointerDown:["mousedown","touchstart"],pointerMove:["mousemove","touchmove"],pointerUp:["mouseup","touchend"],windowResize:["resize"],eventResizeStart:"eventResizeStart.rtc",eventResize:"eventResize.rtc",eventResizeStop:"eventResizeStop.rtc"},t);function t(){}function w(e,t){if("object"!=typeof e||null===e||"[object HTMLTableElement]"!==e.toString())throw'Invalid argument: "table".\nResizableTableColumns requires that the table element is a not null HTMLTableElement object!';if(void 0!==e[y.dataPropertyname])throw'Existing "'+y.dataPropertyname+"\" property.\nTable elemet already has a '"+y.dataPropertyname+"' attached object!";this.id=w.getInstanceId(),this.table=e,this.options=new i(t,e),this.wrapper=null,this.ownerDocument=e.ownerDocument,this.tableHeaders=[],this.dragHandlesContainer=null,this.originalWidths={},this.eventData=null,this.lastPointerDown=0,this.init(),this.table[y.dataPropertyname]=this}return w.prototype.init=function(){this.validateMarkup(),this.createHandlerReferences(),this.wrapTable(),this.asignTableHeaders(),this.storeOriginalWidths(),this.setHeaderWidths(),this.createDragHandles(),this.restoreColumnWidths(),this.checkTableWidth(),this.syncHandleWidths(),this.registerWindowResizeHandler()},w.prototype.dispose=function(){this.destroyDragHandles(),this.restoreOriginalWidths(),this.unwrapTable(),this.onPointerDownRef=null,this.onPointerMoveRef=null,this.onPointerUpRef=null,this.table[y.dataPropertyname]=void 0},w.prototype.validateMarkup=function(){for(var e=0,t=0,n=null,i=0;i<this.table.childNodes.length;i++)"THEAD"===(r=this.table.childNodes[i]).nodeName?(e++,n=r):"TBODY"===r.nodeName&&t++;if(null===n||1!==e)throw"Markup validation: thead count.\nResizableTableColumns requires that the table element has one(1) table head element. Current count: "+e;if(1!==t)throw"Markup validation: tbody count.\nResizableTableColumns requires that the table element has one(1) table body element. Current count: "+t;for(var a=0,s=null,i=0;i<n.childNodes.length;i++)"TR"===(r=n.childNodes[i]).nodeName&&(a++,null===s&&(s=r));if(null===s||a<1)throw"Markup validation: thead row count.\nResizableTableColumns requires that the table head element has at least one(1) table row element. Current count: "+a;for(var r,o=0,l=0,i=0;i<s.childNodes.length;i++)"TH"===(r=s.childNodes[i]).nodeName?o++:"TD"===r.nodeName&&l++;if(o<1)throw"Markup validation: thead first row cells count.\nResizableTableColumns requires that the table head's first row element has at least one(1) table header cell element. Current count: "+o;if(0!==l)throw"Markup validation: thead first row invalid.\nResizableTableColumns requires that the table head's first row element has no(0) table cell(TD) elements. Current count: "+l},w.prototype.wrapTable=function(){var e;this.wrapper||(this.wrapper=this.ownerDocument.createElement("div"),(e=this.table.parentNode).insertBefore(this.wrapper,this.table),e.removeChild(this.table),this.wrapper.appendChild(this.table),g.addClass(this.wrapper,y.classes.wrapper),g.addClass(this.table,y.classes.table))},w.prototype.unwrapTable=function(){var e;g.removeClass(this.table,y.classes.table),this.wrapper&&((e=this.wrapper.parentNode).insertBefore(this.table,this.wrapper),e.removeChild(this.wrapper),this.wrapper=null)},w.prototype.asignTableHeaders=function(){for(var e,t,n=0;n<this.table.childNodes.length;n++)if("THEAD"===(i=this.table.childNodes[n]).nodeName){e=i;break}if(e){for(n=0;n<e.childNodes.length;n++)if("TR"===(i=e.childNodes[n]).nodeName){t=i;break}if(t)for(var i,n=0;n<t.childNodes.length;n++)"TH"===(i=t.childNodes[n]).nodeName&&this.tableHeaders.push(i)}},w.prototype.storeOriginalWidths=function(){var n=this;this.tableHeaders.forEach(function(e,t){n.originalWidths["___."+t]=e.style.width}),this.originalWidths["___.table"]=this.table.style.width},w.prototype.restoreOriginalWidths=function(){var n=this;this.tableHeaders.forEach(function(e,t){e.style.width=n.originalWidths["___."+t]}),this.table.style.width=this.originalWidths["___.table"]},w.prototype.setHeaderWidths=function(){var a=this;this.tableHeaders.forEach(function(e,t){var n=g.getWidth(e),i=a.constrainWidth(e,n);w.setWidth(e,i)})},w.prototype.constrainWidth=function(e,t){var n=t,i=this.options.obeyCssMinWidth?g.getMinCssWidth(e):-1/0,n=Math.max(n,i||0,this.options.minWidth||-1/0),a=this.options.obeyCssMaxWidth?g.getMaxCssWidth(e):1/0;return Math.min(n,a||0,this.options.maxWidth||1/0)},w.prototype.createDragHandles=function(){var e,a=this;if(null!=this.dragHandlesContainer)throw"Drag handlers allready created. Call <destroyDragHandles> if you wish to recreate them";this.dragHandlesContainer=this.ownerDocument.createElement("div"),null!==(e=this.wrapper)&&void 0!==e&&e.insertBefore(this.dragHandlesContainer,this.table),g.addClass(this.dragHandlesContainer,y.classes.handleContainer),this.getResizableHeaders().forEach(function(e,t){var n,i=a.ownerDocument.createElement("div");g.addClass(i,y.classes.handle),null!==(n=a.dragHandlesContainer)&&void 0!==n&&n.appendChild(i)}),y.events.pointerDown.forEach(function(e,t){var n;null!==(n=a.dragHandlesContainer)&&void 0!==n&&n.addEventListener(e,a.onPointerDownRef,!1)})},w.prototype.destroyDragHandles=function(){var e,t,i=this;null!==this.dragHandlesContainer&&(y.events.pointerDown.forEach(function(e,t){var n;null!==(n=i.dragHandlesContainer)&&void 0!==n&&n.removeEventListener(e,i.onPointerDownRef,!1)}),null!==(t=null===(e=this.dragHandlesContainer)||void 0===e?void 0:e.parentElement)&&void 0!==t&&t.removeChild(this.dragHandlesContainer))},w.prototype.getDragHandlers=function(){var e=null==this.dragHandlesContainer?null:this.dragHandlesContainer.querySelectorAll("."+y.classes.handle);return e?Array.prototype.slice.call(e).filter(function(e){return"DIV"===e.nodeName}):new Array},w.prototype.restoreColumnWidths=function(){var e,i;this.options.store&&(0===(e=w.generateTableId(this.table)).length||(i=this.options.store.get(e))&&(this.getResizableHeaders().forEach(function(e,t){var n=i.columns[w.generateColumnId(e)];void 0!==n&&w.setWidth(e,n)}),void 0!==i.table&&w.setWidth(this.table,i.table)))},w.prototype.checkTableWidth=function(){var e=g.getWidth(this.wrapper),t=e-g.getOuterWidth(this.table,!0);if(0<t){var i=0,a=0,n=0,s=[];this.tableHeaders.forEach(function(e,t){var n=w.getWidth(e);s.push(n),i+=n,e.hasAttribute(y.attibutes.dataResizable)&&(a+=n)}),w.setWidth(this.table,e);for(var r=0;r<this.tableHeaders.length;r++){var o,l,d,h=this.tableHeaders[r],u=s.shift();if(h.hasAttribute(y.attibutes.dataResizable)?(l=u+u/a*t,o=i+t-n,l=Math.min(l,o),l=Math.max(l,0),d=this.constrainWidth(h,l),w.setWidth(h,d),n+=l):n+=u,i<=n)break}}},w.prototype.syncHandleWidths=function(){var s=this,e=g.getWidth(this.table);w.setWidth(this.dragHandlesContainer,e),this.dragHandlesContainer.style.minWidth=e+"px";var r=this.getResizableHeaders();this.getDragHandlers().forEach(function(e,t){var n,i,a=g.getInnerHeight(s.options.resizeFromBody?s.table:s.table.tHead);t<r.length&&(n=r[t],i=g.getOuterWidth(n),i+=g.getOffset(n).left,i-=g.getOffset(s.dragHandlesContainer).left,e.style.left=i+"px",e.style.height=a+"px")})},w.prototype.getResizableHeaders=function(){return this.tableHeaders.filter(function(e,t){return e.hasAttribute(y.attibutes.dataResizable)})},w.prototype.handlePointerDown=function(e){this.handlePointerUp();var t,n,i,a,s,r,o,l,d,h,u=e?e.target:null;null!=u&&"DIV"===u.nodeName&&g.hasClass(u,y.classes.handle)&&("number"==typeof e.button&&0!==e.button||(t=u,(n=this.getDragHandlers().indexOf(t))>=(i=this.getResizableHeaders()).length||(s=(a=(new Date).getTime())-this.lastPointerDown<this.options.doubleClickDelay,r=i[n],o=w.getWidth(r),l=w.getWidth(this.table),(d=new c(r,t)).pointer={x:g.getPointerX(e),isDoubleClick:s},d.originalWidths={column:o,table:l},this.detachHandlers(),this.attachHandlers(),g.addClass(this.table,y.classes.tableResizing),g.addClass(this.wrapper,y.classes.tableResizing),g.addClass(t,y.classes.columnResizing),g.addClass(r,y.classes.columnResizing),this.lastPointerDown=a,this.eventData=d,h=new CustomEvent(y.events.eventResizeStart,{detail:{column:r,columnWidth:o,table:this.table,tableWidth:l}}),this.table.dispatchEvent(h),e.preventDefault())))},w.prototype.handlePointerMove=function(e){var t,n,i,a;this.eventData&&e&&0!=(t=(g.getPointerX(e)||0)-(this.eventData.pointer.x||0))&&(n=this.eventData.originalWidths.table+t,i=this.constrainWidth(this.eventData.column,this.eventData.originalWidths.column+t),w.setWidth(this.table,n),w.setWidth(this.eventData.column,i),this.eventData.newWidths={column:i,table:n},a=new CustomEvent(y.events.eventResize,{detail:{column:this.eventData.column,columnWidth:i,table:this.table,tableWidth:n}}),this.table.dispatchEvent(a))},w.prototype.handlePointerUp=function(){var e,t;this.detachHandlers(),this.eventData&&(this.eventData.pointer.isDoubleClick&&this.handleDoubleClick(),g.removeClass(this.table,y.classes.tableResizing),g.removeClass(this.wrapper,y.classes.tableResizing),g.removeClass(this.eventData.dragHandler,y.classes.columnResizing),g.removeClass(this.eventData.column,y.classes.columnResizing),this.checkTableWidth(),this.syncHandleWidths(),this.refreshWrapperStyle(),this.saveColumnWidths(),e=this.eventData.newWidths||this.eventData.originalWidths,t=new CustomEvent(y.events.eventResizeStop,{detail:{column:this.eventData.column,columnWidth:e.column,table:this.table,tableWidth:e.table}}),this.table.dispatchEvent(t),this.eventData=null)},w.prototype.handleDoubleClick=function(){if(this.eventData&&this.eventData.column){var e=this.eventData.column,t=this.tableHeaders.indexOf(e),n=0,i=[];this.tableHeaders.forEach(function(e,t){e.hasAttribute(y.attibutes.dataResizable)||i.push(t)});var a=this.ownerDocument.createElement("span");a.style.position="absolute",a.style.left="-99999px",a.style.top="-99999px",a.style.visibility="hidden",this.ownerDocument.body.appendChild(a);for(var s=this.table.querySelectorAll("tr"),r=0;r<s.length;r++)for(var o=s[r].querySelectorAll("td, th"),l=0,d=0;d<o.length;d++){var h,u,c=o[d],p=1;if(c.hasAttribute("colspan")&&(h=c.getAttribute("colspan")||"1",u=parseInt(h),p=isNaN(u)?1:u),-1===i.indexOf(d)&&1===p&&l===t){n=Math.max(n,g.getTextWidth(c,a));break}l+=p}this.ownerDocument.body.removeChild(a);var f,v,b,m=n-g.getWidth(e);0!=m&&(f=this.eventData.originalWidths.table+m,v=this.constrainWidth(this.eventData.column,this.eventData.originalWidths.column+m),w.setWidth(this.table,f),w.setWidth(this.eventData.column,v),this.eventData.newWidths={column:v,table:f},b=new CustomEvent(y.events.eventResize,{detail:{column:this.eventData.column,columnWidth:v,table:this.table,tableWidth:f}}),this.table.dispatchEvent(b))}},w.prototype.attachHandlers=function(){var n=this;y.events.pointerMove.forEach(function(e,t){n.ownerDocument.addEventListener(e,n.onPointerMoveRef,!1)}),y.events.pointerUp.forEach(function(e,t){n.ownerDocument.addEventListener(e,n.onPointerUpRef,!1)})},w.prototype.detachHandlers=function(){var n=this;y.events.pointerMove.forEach(function(e,t){n.ownerDocument.removeEventListener(e,n.onPointerMoveRef,!1)}),y.events.pointerUp.forEach(function(e,t){n.ownerDocument.removeEventListener(e,n.onPointerUpRef,!1)})},w.prototype.refreshWrapperStyle=function(){var e;null!=this.wrapper&&(e=this.wrapper.style.overflowX,this.wrapper.style.overflowX="hidden",this.wrapper.style.overflowX=e)},w.prototype.saveColumnWidths=function(){var e,n;!this.options.store||0!==(e=w.generateTableId(this.table)).length&&(n={table:w.getWidth(this.table),columns:{}},this.getResizableHeaders().forEach(function(e,t){n.columns[w.generateColumnId(e)]=w.getWidth(e)}),this.options.store.set(e,n))},w.prototype.createHandlerReferences=function(){var t=this;this.onPointerDownRef||(this.onPointerDownRef=function(e){t.handlePointerDown(e)}),this.onPointerMoveRef||(this.onPointerMoveRef=function(e){t.handlePointerMove(e)}),this.onPointerUpRef||(this.onPointerUpRef=function(e){t.handlePointerUp()})},w.prototype.registerWindowResizeHandler=function(){var n=this.ownerDocument.defaultView;w.windowResizeHandlerRegistered||(w.windowResizeHandlerRegistered=!0,y.events.windowResize.forEach(function(e,t){null!=n&&n.addEventListener(e,w.onWindowResize,!1)}))},w.prototype.handleWindowResize=function(){this.checkTableWidth(),this.syncHandleWidths()},w.onWindowResize=function(e){var t=e?e.target:null;if(null!=t)for(var n=t.document.querySelectorAll("."+y.classes.table),i=0;i<n.length;i++){var a=n[i];"object"==typeof a[y.dataPropertyname]&&a[y.dataPropertyname].handleWindowResize()}},w.generateColumnId=function(e){return(e.getAttribute(y.attibutes.dataResizable)||"").trim().replace(/\./g,"_")},w.generateTableId=function(e){var t=(e.getAttribute(y.attibutes.dataResizableTable)||"").trim().replace(/\./g,"_");return t.length?"rtc/"+t:t},w.getWidth=function(e){return""===e.style.width?g.getWidth(e):s.parseStyleDimension(e.style.width,!1)},w.setWidth=function(e,t){var n=t.toFixed(2),n=0<t?n:"0";e.style.width=n+"px"},w.getInstanceId=function(){return w.instancesCount++},w.instancesCount=0,w.windowResizeHandlerRegistered=!1,w});